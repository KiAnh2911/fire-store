{"version":3,"file":"todoRespository.js","names":["_config","_interopRequireDefault","require","obj","__esModule","default","admin","todoRef","db","collection","getListTodo","sort","limit","todos","orderBy","Number","get","docs","map","doc","id","data","getAdd","addTodo","createAt","firestore","Timestamp","now","toDate","completed","todo","add","updateTodos","todoAll","updateAll","filter","todoItem","includes","updates","update","updatedAt","Promise","all","removeManyTodo","ids","todoRemove","String","delete"],"sources":["../../src/database/todoRespository.js"],"sourcesContent":["import db from \"../firestore/config\";\nconst admin = require(\"firebase-admin\");\nconst todoRef = db.collection(\"todos\");\n\nexport async function getListTodo(sort = \"ASC\", limit = 5) {\n  const todos = await todoRef\n    .orderBy(\"createAt\", sort)\n    .limit(Number(limit))\n    .get();\n\n  return todos.docs.map((doc) => {\n    return { id: doc.id, ...doc.data() };\n  });\n}\n\nexport async function getAdd(data) {\n  const addTodo = {\n    createAt: admin.firestore.Timestamp.now().toDate(),\n    ...data,\n    completed: false,\n  };\n\n  const todo = await todoRef.add(addTodo);\n\n  return { id: todo.id, ...addTodo };\n}\n\nexport async function updateTodos(todos = []) {\n  const todoAll = await getListTodo();\n\n  const updateAll = todoAll.filter((todoItem) => {\n    return todos.includes(todoItem.id);\n  });\n\n  const updates = updateAll.map((todo) => {\n    return todoRef.doc(`${todo.id}`).update({\n      ...todo,\n      completed: !todo.completed,\n      updatedAt: admin.firestore.Timestamp.now().toDate(),\n    });\n  });\n  return await Promise.all(updates);\n}\n\nexport async function removeManyTodo(ids = []) {\n  const todoRemove = ids.map((id) => todoRef.doc(String(id)).delete());\n\n  return await Promise.all(todoRemove);\n}\n"],"mappings":";;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAqC,SAAAD,uBAAAE,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AACrC,MAAMG,KAAK,GAAGJ,OAAO,CAAC,gBAAgB,CAAC;AACvC,MAAMK,OAAO,GAAGC,eAAE,CAACC,UAAU,CAAC,OAAO,CAAC;AAE/B,eAAeC,WAAWA,CAACC,IAAI,GAAG,KAAK,EAAEC,KAAK,GAAG,CAAC,EAAE;EACzD,MAAMC,KAAK,GAAG,MAAMN,OAAO,CACxBO,OAAO,CAAC,UAAU,EAAEH,IAAI,CAAC,CACzBC,KAAK,CAACG,MAAM,CAACH,KAAK,CAAC,CAAC,CACpBI,GAAG,CAAC,CAAC;EAER,OAAOH,KAAK,CAACI,IAAI,CAACC,GAAG,CAAEC,GAAG,IAAK;IAC7B,OAAO;MAAEC,EAAE,EAAED,GAAG,CAACC,EAAE;MAAE,GAAGD,GAAG,CAACE,IAAI,CAAC;IAAE,CAAC;EACtC,CAAC,CAAC;AACJ;AAEO,eAAeC,MAAMA,CAACD,IAAI,EAAE;EACjC,MAAME,OAAO,GAAG;IACdC,QAAQ,EAAElB,KAAK,CAACmB,SAAS,CAACC,SAAS,CAACC,GAAG,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC;IAClD,GAAGP,IAAI;IACPQ,SAAS,EAAE;EACb,CAAC;EAED,MAAMC,IAAI,GAAG,MAAMvB,OAAO,CAACwB,GAAG,CAACR,OAAO,CAAC;EAEvC,OAAO;IAAEH,EAAE,EAAEU,IAAI,CAACV,EAAE;IAAE,GAAGG;EAAQ,CAAC;AACpC;AAEO,eAAeS,WAAWA,CAACnB,KAAK,GAAG,EAAE,EAAE;EAC5C,MAAMoB,OAAO,GAAG,MAAMvB,WAAW,CAAC,CAAC;EAEnC,MAAMwB,SAAS,GAAGD,OAAO,CAACE,MAAM,CAAEC,QAAQ,IAAK;IAC7C,OAAOvB,KAAK,CAACwB,QAAQ,CAACD,QAAQ,CAAChB,EAAE,CAAC;EACpC,CAAC,CAAC;EAEF,MAAMkB,OAAO,GAAGJ,SAAS,CAAChB,GAAG,CAAEY,IAAI,IAAK;IACtC,OAAOvB,OAAO,CAACY,GAAG,CAAE,GAAEW,IAAI,CAACV,EAAG,EAAC,CAAC,CAACmB,MAAM,CAAC;MACtC,GAAGT,IAAI;MACPD,SAAS,EAAE,CAACC,IAAI,CAACD,SAAS;MAC1BW,SAAS,EAAElC,KAAK,CAACmB,SAAS,CAACC,SAAS,CAACC,GAAG,CAAC,CAAC,CAACC,MAAM,CAAC;IACpD,CAAC,CAAC;EACJ,CAAC,CAAC;EACF,OAAO,MAAMa,OAAO,CAACC,GAAG,CAACJ,OAAO,CAAC;AACnC;AAEO,eAAeK,cAAcA,CAACC,GAAG,GAAG,EAAE,EAAE;EAC7C,MAAMC,UAAU,GAAGD,GAAG,CAAC1B,GAAG,CAAEE,EAAE,IAAKb,OAAO,CAACY,GAAG,CAAC2B,MAAM,CAAC1B,EAAE,CAAC,CAAC,CAAC2B,MAAM,CAAC,CAAC,CAAC;EAEpE,OAAO,MAAMN,OAAO,CAACC,GAAG,CAACG,UAAU,CAAC;AACtC"}